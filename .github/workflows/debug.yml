name: Debug FOMC Page Structure
on: 
  workflow_dispatch  # 仅允许手动触发，用于测试

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: 1. 检出代码
        uses: actions/checkout@v4

      - name: 2. 安装Python依赖
        run: pip3 install requests beautifulsoup4

      - name: 3. 抓取并保存网页快照
        run: |
          python3 << 'EOF'
          import requests
          url = "https://www.federalreserve.gov/monetarypolicy/fomccalendars.htm"
          headers = {'User-Agent': 'Mozilla/5.0'}
          try:
              r = requests.get(url, headers=headers, timeout=30)
              r.raise_for_status()
              with open("debug_fomc_page.html", "w", encoding="utf-8") as f:
                  f.write(r.text)
              print("✅ 成功：已保存网页快照到 debug_fomc_page.html")
          except Exception as e:
              print(f"❌ 失败：{e}")
          EOF

      - name: 4. 提交调试文件（可选）
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add debug_fomc_page.html
          git commit -m "Add debug page snapshot" || echo "没有新变更，无需提交"
          git push
